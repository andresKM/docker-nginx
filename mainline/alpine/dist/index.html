<!DOCTYPE html>
<html>

<head>
	<!-- Standard Meta -->
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	<!-- Site Properties -->
	<title>Головна сторінка тестового сервісу перевірки деревини - FSC</title>
	<link rel="stylesheet" type="text/css" href="dist/semantic.css">
	<link rel="stylesheet" type="text/css" href="assets/main.css">
	<link rel="stylesheet" type="text/css" href="assets/offline-theme-default.css">
	<link rel="stylesheet" type="text/css" href="assets/offline-language-ua.css">
	<script src="assets/jquery.min.js"></script>
	<script src="dist/semantic.js"></script>
	<script src="assets/modernizr.min.js"></script>
	<script src="assets/offline.min.js"></script>
	<script src="assets/elasticsearch.jquery.min.js"></script>
	<script>
	var client = new $.es.Client({
		host: 'http://eod:eod_pass@swarm1813.cloudout.co:9200'
	});

	$(document).ready(function() {
		// fix menu when passed
		$('.masthead').visibility({
			once: false,
			onBottomPassed: function() {
				// $('.fixed.menu').transition('fade in');
				$('.fixed.menu');
			},
			onBottomPassedReverse: function() {
				// $('.fixed.menu').transition('fade out');
				$('.fixed.menu');
			}
		});
		// create sidebar and attach to menu open
		$('.ui.sidebar').sidebar('attach events', '.toc.item');

		$("#jumbo_button").click(function() {
			$("#jumbo").hide();
			$(".masthead.segment").css("height", "80px");
			$(".masthead.segment").css("min-height", "80px");
			//$("#main-menu").removeClass(".masthead .segment");
			//$("#main-menu").addClass("main-menu-slim");

			$('#sidebar-menu').sidebar('show');;

			//make here a ping call to db
		});
		$("#start-dimmer").fadeOut(2300);
		$('.tabular.menu .item').tab({
			onFirstLoad: function() {
				$("#jumbo").hide();
				$(".masthead.segment").css("height", "80px");
				$(".masthead.segment").css("min-height", "80px");
			}

		});
		Offline.options = {
			checks: {
				image: {
					url: 'http://www.proderevo.info/favicon.ico'
				},
				active: 'image'
			}
		};
		Offline.check();
		$('.message .close').on('click', function() {
			$(this).closest('.message').hide();
			$(".ui.horizontal.divider").hide();
		});

		var query = Modernizr.mq('(min-width: 400px)');
		if (!query) {
			$(".form > .button").removeClass("large").addClass("small");
		}


		$.fn.submit_car = function() {
			var qq = $("#car-form").form('get field', "search_car").val();
			client.search({
				"index": 'fsc',
				q: "car_number:*"+qq+"*",
				//"q": "*"+qq+"*",
				size: 1
			}).then(function(body) {
				var hits = body.hits.hits;
				console.log(hits);
				$("#results_table_car > table").hide();
				$("#results_table_car > h4").hide();
				$('#results_table_car').removeClass("loading");
				$.fn.renderJson("#results_table_car", hits);
			}, function(error) {
				console.trace(error.message);
			});



		};

		$.fn.submit_ttn = function() {
			var qq = $("#ttn-form").form('get field', "search_ttn").val();
			client.search({
				index: 'fsc',
				q: "ttn:*"+qq+"*",
				//"q": "*"+qq+"*",
				size: 1
			}).then(function(body) {
				var hits = body.hits.hits;
				console.log(hits);
				$("#results_table_ttn > table").hide();
				$("#results_table_ttn > h4").hide();
				$('#results_table_ttn').removeClass("loading");
				$.fn.renderJson("#results_table_ttn", hits);
			}, function(error) {
				console.trace(error.message);
			});

		};


		$.fn.submit_birka = function() {
			var qq = $("#birka-form").form('get field', "search_birka").val();
			client.search({
				index: 'fsc',
				"q": "*"+qq+"*",
				size: 1
			}).then(function(body) {
				var hits = body.hits.hits;
				console.log(hits);
				$("#results_table_birka > table").hide();
				$("#results_table_birka > h4").hide();
				$('#results_table_birka').removeClass("loading");
				$.fn.renderJson("#results_table_birka", hits);
			}, function(error) {
				console.trace(error.message);
			});

		};



		$('#car-form .submit.button').on('click', function() {
			$('#results_table_car').addClass("loading");
			$.fn.submit_car();
		});

		$('#birka-form-form .submit.button').on('click', function() {
			$('#results_table_birka').addClass("loading");
			$.fn.submit_birka();
		});

		$('#ttn-form .submit.button').on('click', function() {
			$('#results_table_ttn').addClass("loading");
			$.fn.submit_ttn();
		});





		$('#car-form').form({
			fields: {
				search_car: {
					identifier: 'search_car',
					rules: [{
						type: 'empty'
					}]
				}
			}
		});



		$('#ttn-form').form({
			fields: {
				search_ttn: {
					identifier: 'search_ttn',
					rules: [{
						type: 'empty'
					}]
				}
			}
		});

		$('#birka-form').form({
			fields: {
				search_birka: {
					identifier: 'search_birka',
					rules: [{
						type: 'empty'
					}]
				}
			}
		});

		$.fn.makeTable = function(mydata) {
			var table = $('<table class="ui compact celled collapsing striped table results_table">');
			// $.each(mydata, function(index, value) {
			// 	var TableRow = "<tr>";
			// 	$.each(value, function(key, val) {
			// 		TableRow += "<td>" + val + "</td>";
			// 	});
			// 	TableRow += "</tr>";
			// 	$(table).append(TableRow);
			// });
			var TableRow = "<tr>";
			TableRow += "<td>Дата ТТН:</td>";
			TableRow += "<td>" + mydata.date_send + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Серія, номер ТТН:</td>";
			TableRow += "<td>" + mydata.ttn + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Вантажоперевізник:</td>";
			TableRow += "<td>" + mydata.transporter_fop + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Держ.номер авто:</td>";
			TableRow += "<td>" + mydata.car_number + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Пункт навантаження:</td>";
			TableRow += "<td>" + mydata.dest_place + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Пункт розвантаження:</td>";
			TableRow += "<td>" + mydata.arrival_place + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Вантажоодержувач</td>";
			TableRow += "<td>" + mydata.cargo_taker + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Сортимент, кількість, об'єм:</td>";
			TableRow += "<td>" + mydata.sortument1 + "</td>";
			TableRow += "<td>" + mydata.number1 + "</td>";
			TableRow += "<td>" + mydata.volume1 + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Сортимент, кількість, об'єм:</td>";
			TableRow += "<td>" + mydata.sortument2 + "</td>";
			TableRow += "<td>" + mydata.number2 + "</td>";
			TableRow += "<td>" + mydata.volume2 + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Сортимент, кількість, об'єм:</td>";
			TableRow += "<td>" + mydata.sortument3 + "</td>";
			TableRow += "<td>" + mydata.number3 + "</td>";
			TableRow += "<td>" + mydata.volume3 + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Сортимент, кількість, об'єм:</td>";
			TableRow += "<td>" + mydata.sortument4 + "</td>";
			TableRow += "<td>" + mydata.number4 + "</td>";
			TableRow += "<td>" + mydata.volume4 + "</td>";
			TableRow += "</tr>";
			TableRow += "<tr><td>Сортимент, кількість, об'єм:</td>";
			TableRow += "<td>" + mydata.sortument5 + "</td>";
			TableRow += "<td>" + mydata.number5 + "</td>";
			TableRow += "<td>" + mydata.volume5 + "</td>";
			TableRow += "</tr>";

			$(table).append(TableRow);
			return ($(table));
		};

		$.fn.renderJson = function(sel, data) {
			//var mydata = eval(data);
			$.each(data, function(idx, obj) {
				console.log(obj._source);
				var table = $.fn.makeTable(obj._source);
				$(table).appendTo(sel);
			});

		};


	});
	</script>
</head>

<body>
	<!-- <div class="se-pre-con"></div> -->
	<div class="ui active dimmer" id="start-dimmer">
		<div class="ui large text loader">Завантаження</div>
	</div>
	
	<!-- Sidebar Menu -->
	<div class="ui vertical inverted sidebar menu tabular" id="sidebar-menu">
		<a class="active item">Головна</a>
		<a class="item" data-tab="tab-car">Пошук по авто</a>
		<a class="item" data-tab="tab-ttn">Пошук по ТТН</a>
		<a class="item" data-tab="tab-birka">Пошук по бірці</a>
	</div>
	<!-- Page Contents -->
	<div class="pusher">
		<div class="ui inverted vertical masthead center aligned segment" id="main-menu">
			<div class="ui container">
				<div class="ui medium secondary inverted pointing menu tabular">
					<a class="toc item">
						<i class="sidebar icon"></i>
					</a>
					<a class="active item">Головна</a>
					<a class="item" data-tab="tab-car">Пошук по авто</a>
					<a class="item" data-tab="tab-ttn">Пошук по ТТН</a>
					<a class="item" data-tab="tab-birka">Пошук по бірці</a>
					<div class="right item">
						<a class="ui inverted button">Як користуватися</a>
					</div>
				</div>
			</div>
			<div class="ui text container" id="jumbo">
				<h1 class="ui inverted header">
					Тестовий сервіс перевірки походження деревини
				</h1>
				<!-- 	<h2>Do whatever you want when you want to.</h2> -->
				<div class="ui huge primary button" id="jumbo_button">Розпочати <i class="right arrow icon"></i></div>
			</div>
		</div>
		<div class="ui tab" data-tab="tab-car">
			<div class="ui raised very padded text container segment">
				<div class="ui huge form" id="car-form">
					<div class="field">
						<label>Введіть номер авто для перевірки</label>
						<input placeholder="Введіть Ваш запит" type="text" name="search_car">
					</div>
					<!-- <div class="ui buttons">
						<div class="ui large blue submit button">
							<i class="search icon"></i> Пошук
						</div>
						<div class="ui large yellow right floated clear button">Зкинути</div>
					</div> -->
					<div class="ui large blue submit button">
						<i class="search icon"></i> Пошук
					</div>
					<div class="ui large yellow right floated clear button">Зкинути</div>
				</div>
			</div>
			<div class="ui raised text padded container segment" id="results_table_car">
				<h4 class="ui header center aligned grey">
					Тут будуть відображені результати пошуку
				</h4>
			</div>
		</div>
		<div class="ui tab" data-tab="tab-ttn">
			<div class="ui raised very padded text container segment">
				<div class="ui huge form" id="ttn-form">
					<div class="field">
						<label>Введіть номер ТТН для перевірки</label>
						<input placeholder="Введіть Ваш запит" type="text" name="search_ttn">
					</div>
					<div class="ui large blue submit button">
						<i class="search icon"></i> Пошук
					</div>
					<div class="ui large yellow right floated clear button">Зкинути</div>
				</div>
			</div>
			<div class="ui raised text padded container segment" id="results_table_ttn">
				<h4 class="ui header center aligned grey">
					Тут будуть відображені результати пошуку
				</h4>
			</div>
		</div>
		<div class="ui tab" data-tab="tab-birka">
			<div class="ui raised very padded text container segment">
				<div class="ui huge form" id="birka-form">
					<div class="field">
						<label>Введіть номер бирки для перевірки</label>
						<input placeholder="Введіть Ваш запит" type="text" name="search_birka">
					</div>
					<div class="ui large blue submit button">
						<i class="search icon"></i> Пошук
					</div>
					<div class="ui large yellow right floated clear button">Зкинути</div>
				</div>
			</div>
			<div class="ui raised text padded container segment" id="results_table_birka">
				<h4 class="ui header center aligned grey">
					Тут будуть відображені результати пошуку
				</h4>
			</div>
		</div>
		<div class="ui raised very padded text container segment" id="dumb_content">
			<h3 class="ui header">Застосування табличного методу значно полегшує орієнтацію в матеріалі. </h3>
			<p>Дані по введеному запиту буде відображено у наступному вигляді:</p>
			<table class="ui compact celled collapsing unstackable striped table results_table">
				<thead>
					<tr>
						<th>Header</th>
						<th>Header</th>
						<th>Header</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>Cell</td>
						<td>Cell</td>
						<td>Cell</td>
					</tr>
					<tr>
						<td>Cell</td>
						<td>Cell</td>
						<td>Cell</td>
					</tr>
					<tr>
						<td>Cell</td>
						<td>Cell</td>
						<td>Cell</td>
					</tr>
				</tbody>
			</table>
			<h4 class="ui horizontal header divider">
		        		<a href="#">ДО УВАГИ</a>
		      </h4>
			<div class="ui info message">
				<i class="close icon"></i>
				<div class="header">
					Прийміть до уваги наступне:
				</div>
				<ul class="list">
					<li>Наголошуємо, що сервіс працює у тестовому режимі</li>
					<li>Сервіс на данний момент працює з БД, наповненою тестовими даними</li>
				</ul>
			</div>
		</div>
		<div class="ui inverted vertical footer segment">
			<div class="ui container">
				<div class="ui stackable inverted divided equal height stackable grid">
					<div class="seven wide centered column">
						<h3 class="ui inverted header">Звязок з адміністратором сайту: mail@proderevo.info</h3>
						<!-- <h4 class="ui inverted ">Fo</h4> -->
						<!-- <p>Extra space for a call to action inside the footer that could help re-engage users.</p> -->
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>
